---
layout: post
date: 2024-01-25
title: "Advanced Android App Analysis - 1. í™˜ê²½ ì„¸íŒ…"
tags: [0-day, android, ]
categories: [Vulnerable Research, ]
---


# 1. ê°œìš”


---


## 1.1. íƒ€ê²Ÿ ì„¤ì •


ì•ˆë“œë¡œì´ë“œ ì•± ì·¨ì•½ì  ë¶„ì„ì— ë“¤ì–´ê°€ê¸° ì „, ì–´ë–¤ ì•±ì„ ë¶„ì„í• ì§€ ê³ ë¯¼ì„ í•´ ë³´ì•˜ë‹¤. 20~30 ëŒ€ê°€ ë§ì´ ì‚¬ìš©í•˜ê³ , ê¸°ëŠ¥ë„ ì ë‹¹íˆ ì ë‹¹í•œ(?) ì•±ì„ ê³ ë¯¼í•˜ë‹¤ê°€ ë‘ ì¢…ë¥˜ì˜ ì•±ì´ ì¶”ë ¤ì¡Œë‹¤.


> **íƒ€ê²Ÿ ì•± ëª©ë¡**

1. **í•™ìŠµ ì„œí¬íŠ¸ ì•±**
	- ì—´í’ˆíƒ€, ì—´ê³µì‹œê°„, ì˜¬í´, ë§ˆì´ë£¨í‹´, ë£¨í‹°ë„ˆë¦¬
2. **íŒ¨ì…˜ ì‡¼í•‘ ì•±**
	- í•˜ì´ë²„, ë¬´ì‹ ì‚¬, í¬ë¦¼, ì—ì´ë¸”ë¦¬, ì§€ê·¸ì¬ê·¸

> 


ë‘˜ë‹¤ 20~30ëŒ€ê°€ ë§ì´ ì‚¬ìš©í• ë§Œí•œ ì•±ì´ê³ , ê²°ì œë‚˜ ì¸ì¦ ê°™ì€ ê¸°ëŠ¥ë„ ì ì ˆíˆ ìˆì–´ì„œ í›„ë³´êµ°ìœ¼ë¡œ ìƒê°í•´ë³´ì•˜ë‹¤. ë‘ ì£¼ì œ ì¤‘ì—ì„œ ì–´ë–¤ ê²ƒì„ íƒ€ê²Ÿìœ¼ë¡œ í• ì§€ëŠ” ì•„ì§ ì •í•˜ì§€ ì•Šì•˜ìœ¼ë©°, í™˜ê²½ êµ¬ì¶• ì´í›„ì— í™•ì‹¤í•˜ê²Œ ì •í•  ê²ƒ ê°™ë‹¤.


## 1.2. ì¤€ë¹„ë¬¼


í™˜ê²½ ë¶„ì„ì— ëŒ€í•œ ë‚´ìš©ì„ ì •ë¦¬í•œ í¬ìŠ¤í„°ì´ë‹¤. ë¨¼ì € `ëª¨ë°”ì¼ ì·¨ì•½ì  ë¶„ì„` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê²€ìƒ‰í•´ë³´ì•˜ì„ ë•Œ í•„ìš”í•œ ì¤€ë¹„ë¬¼ì€ ì•„ë˜ì™€ ê°™ë‹¤.


> ğŸ’¡ **ëª¨ë°”ì¼ ì·¨ì•½ì  ë¶„ì„ ì¤€ë¹„**  
> 1. **í”„ë¡ì‹œ íˆ´**  
>   
> 2. **ì•ˆë“œë¡œì´ë“œ OS**

	1. **í”„ë¡ì‹œ íˆ´**
		- Frida
		- Burp Suite
		- Fiddler
	2. **ì•ˆë“œë¡œì´ë“œ OS**
		- ë£¨íŒ…ëœ ì•ˆë“œë¡œì´ë“œ ë‹¨ë§ê¸°
		- ì•ˆë“œë¡œì´ë“œ ì—ë®¬ë ˆì´í„°

{% raw %}
```markdown
<aside>
ğŸ’¡ **ëª¨ë°”ì¼ ì·¨ì•½ì  ë¶„ì„ ì¤€ë¹„**

1. **í”„ë¡ì‹œ íˆ´**
    - Frida
    - Burp Suite
    - Fiddler
    
2. **ì•ˆë“œë¡œì´ë“œ OS**
    - ë£¨íŒ…ëœ ì•ˆë“œë¡œì´ë“œ ë‹¨ë§ê¸°
    - ì•ˆë“œë¡œì´ë“œ ì—ë®¬ë ˆì´í„°
</aside>
```
{% endraw %}


í”„ë¡ì‹œ íˆ´ ì¤‘ì—ì„œ ì‹¤ì§ˆì ìœ¼ë¡œ ë§ì´ í™œìš©í•´ë³¸ ê²ƒì€ â€˜Burp Suiteâ€™ ì´ì§€ë§Œ, ëª¨ë°”ì¼ ì·¨ì•½ì  ë¶„ì„ì—ëŠ” Frida í‹€ì„ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê°™ì•„ì„œ íˆ´ ì‚¬ìš©ë²•ë„ ìµí ê²¸ **Frida ë¥¼ ì‚¬ìš©í•˜ê¸°ë¡œ ê²°ì • í–ˆë‹¤.**


ì•ˆë“œë¡œì´ë“œ OS ê°™ì€ ê²½ìš° ì•ˆë“œë¡œì´ë“œ í°ì´ ìˆê¸´ í•˜ì§€ë§Œ, í˜¸í™˜ì„± ë“±ì˜ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ë„ ìˆì–´ì„œ(ê°¤ëŸ­ì‹œ ë…¸íŠ¸ 9..) ì—ë¬¼ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ê¸°ë¡œ í–ˆë‹¤. 


í•˜ì§€ë§Œ ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ì™€ ê°™ì´ ìš©ëŸ‰ë§Œ ë§ì´ ì°¨ì§€í•˜ëŠ” ìœ¡ì¤‘í•œ íˆ´ë¡œ ë‚´ ë§¥ë¶ì„ ë”ëŸ½íˆê³  ì‹¶ì§€ ì•Šì•˜ë‹¤. ì´ëŸ¬í•œ ìƒê°ìœ¼ë¡œ chatGPTì—ê²Œ ë„ì›€ì„ êµ¬í–ˆê³ , command line tools ì„ ì‚¬ìš©í•œ AVD(android virtual device) ë‹¤ìš´ë¡œë“œ ë° ì—ë®¬ë ˆì´íŠ¸ë¥¼ í†µí•´ ë¶„ì„ í™˜ê²½ì„ êµ¬ì¶•í•˜ì˜€ë‹¤.


# 2. í™˜ê²½ êµ¬ì¶•


---


## 2.1. ê°€ìƒ ë¨¸ì‹  ì„¤ì¹˜


ë¶„ì„ì„ ìœ„í•œ ê°€ìƒ ë¨¸ì‹ ì„ ì„¤ì¹˜í–ˆë‹¤. windows ë¥¼ ì‚¬ìš©í–ˆë‹¤ë©´ vmware ë¥¼ ì‚¬ìš©í•˜ì—¬ ubuntu22.04 amd64 ë²„ì „ì„ ì„¤ì¹˜í–ˆê² ì§€ë§Œ, ë§¥ë¶ì„ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— `Parellels` ë¥¼ ì‚¬ìš©í•˜ì—¬ `ubuntu22.04 aarch64` ë¥¼ ì„¤ì¹˜í–ˆë‹¤.


> Host


> 

	- machine : Macbook Air
	- arch : Apple m1
	- memory : 16GB
	- ssd : 1TB

### Guest

- Hypervisor : Parellels
- OS : ubuntu22.04
- arch : aarch64

## 2.2. Android SDK ì„¤ì¹˜


`android sdk` ê²€ìƒ‰ì„ í†µí•´ Android ê³µì‹ ë‹¤ìš´ë¡œë“œ í˜ì´ì§€ì— ë“¤ì–´ê°€ë©´ ëª‡ê°€ì§€ ë‹¤ìš´ë¡œë“œ ë§í¬ë“¤ì´ ìˆë‹¤. ë¨¼ì € ì–´ë–¤ ë„êµ¬ë¥¼ ë°›ì•„ì•¼ë ì§€ ì•Œì•„ë³´ê¸° ìœ„í•´ [`SDK ë„êµ¬`](https://developer.android.com/tools?hl=ko) í˜ì´ì§€ì— ë“¤ì–´ê°€ë³´ì•˜ë‹¤.


í•´ë‹¹ í˜ì´ì§€ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë„êµ¬ë“¤ì´ ìˆì—ˆë‹¤.


> **SDK ë„êµ¬ ì¢…ë¥˜**

- **Android SDK ëª…ë ¹ì¤„ ë„êµ¬**
	- [`apkanalyzer`](https://developer.android.com/studio/command-line/apkanalyzer?hl=ko) : ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ê°€ ì™„ë£Œëœ í›„ APKì˜ êµ¬ì„±ì— ê´€í•œ ìœ ìš©í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
	- [`avdmanager`](https://developer.android.com/studio/command-line/avdmanager?hl=ko) : ëª…ë ¹ì¤„ì—ì„œ Android Virtual Device(AVD)ë¥¼ ë§Œë“¤ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
	- [`lint`](https://developer.android.com/studio/write/lint?hl=ko#commandline) : ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ì—¬ ì½”ë“œì˜ êµ¬ì¡°ì  í’ˆì§ˆ ë¬¸ì œë¥¼ ì‹ë³„í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•©ë‹ˆë‹¤.
	- [`retrace`](https://developer.android.com/studio/command-line/retrace?hl=ko) : R8ë¡œ ì»´íŒŒì¼ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê²½ìš°Â `retrace`ëŠ” ì›ë˜ ì†ŒìŠ¤ ì½”ë“œì— ë‹¤ì‹œ ë§¤í•‘ë˜ëŠ” ë‚œë…í™”ëœ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ë¥¼ ë””ì½”ë”©í•©ë‹ˆë‹¤.
	- [`sdkmanager`](https://developer.android.com/studio/command-line/sdkmanager?hl=ko) : Android SDKìš© íŒ¨í‚¤ì§€ë¥¼ ë³´ê³  ì„¤ì¹˜í•˜ê³  ì—…ë°ì´íŠ¸í•˜ê³  ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **Android SDK ë¹Œë“œ ë„êµ¬**
	- [`AAPT2`](https://developer.android.com/studio/command-line/aapt2?hl=ko) : Android ë¦¬ì†ŒìŠ¤ë¥¼ Android í”Œë«í¼ì— ìµœì í™”ëœ ë°”ì´ë„ˆë¦¬ í˜•ì‹ìœ¼ë¡œ íŒŒì‹±í•˜ê³  ìƒ‰ì¸ì„ ìƒì„±í•˜ë©° ì»´íŒŒì¼í•œ í›„ ì»´íŒŒì¼ëœ ë¦¬ì†ŒìŠ¤ë¥¼ ë‹¨ì¼ ì¶œë ¥ìœ¼ë¡œ íŒ¨í‚¤ì§•í•©ë‹ˆë‹¤.
	- [`apksigner`](https://developer.android.com/studio/command-line/apksigner?hl=ko) : APKì— ì„œëª…í•˜ê³  APK ì„œëª…ì´ ì§€ì •ëœ APKê°€ ì§€ì›í•˜ëŠ” ëª¨ë“  í”Œë«í¼ ë²„ì „ì—ì„œ ì„±ê³µì ìœ¼ë¡œ ì¸ì¦ë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
	- [`zipalign`](https://developer.android.com/studio/command-line/zipalign?hl=ko) : ì••ì¶•ë˜ì§€ ì•Šì€ ëª¨ë“  ë°ì´í„°ê°€ íŒŒì¼ ì‹œì‘ ë¶€ë¶„ì„ ê¸°ì¤€ìœ¼ë¡œ íŠ¹ì • ì •ë ¬ì´ ì ìš©ëœ ìƒíƒœë¡œ ì‹œì‘ë˜ë„ë¡ í•˜ì—¬ APK íŒŒì¼ì„ ìµœì í™”í•©ë‹ˆë‹¤.
- **Android SDK í”Œë«í¼ ë„êµ¬**
	- [`adb`](https://developer.android.com/studio/command-line/adb?hl=ko) : adb(Android ë””ë²„ê·¸ ë¸Œë¦¬ì§€)ëŠ” ì—ë®¬ë ˆì´í„° ì¸ìŠ¤í„´ìŠ¤ ë˜ëŠ” Android ì§€ì› ê¸°ê¸°ì˜ ìƒíƒœë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë‹¤ëª©ì  ë„êµ¬ì…ë‹ˆë‹¤. adbë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ê¸°ì— APKë¥¼ ì„¤ì¹˜í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
	- [`etc1tool`](https://developer.android.com/studio/command-line/etc1tool?hl=ko) : PNG ì´ë¯¸ì§€ë¥¼ ETC1 ì••ì¶• í‘œì¤€ìœ¼ë¡œ ì¸ì½”ë”©í•˜ê³  ì••ì¶•ëœ ETC1 ì´ë¯¸ì§€ë¥¼ PNGë¡œ ë‹¤ì‹œ ë””ì½”ë”©í•  ìˆ˜ ìˆëŠ” ëª…ë ¹ì¤„ ìœ í‹¸ë¦¬í‹°ì…ë‹ˆë‹¤.
	- `fastboot` : ê¸°ê¸°ë¥¼ í”Œë«í¼ ë° ê¸°íƒ€ ì‹œìŠ¤í…œ ì´ë¯¸ì§€ë¡œ í”Œë˜ì‹œí•©ë‹ˆë‹¤. í”Œë˜ì‹œ ì•ˆë‚´ëŠ”Â [Nexus ë° Pixel ê¸°ê¸°ìš© ê³µì¥ ì¶œê³  ì‹œ ì´ë¯¸ì§€](https://developers.google.com/android/images?hl=ko)ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.
	- [`logcat`](https://developer.android.com/studio/command-line/logcat?hl=ko) : ì•± ë° ì‹œìŠ¤í…œ ë¡œê·¸ë¥¼ ë³´ê¸° ìœ„í•´ adbì—ì„œ í˜¸ì¶œí•©ë‹ˆë‹¤.
- **Android Emulator**
	- [`emulator`](https://developer.android.com/studio/run/emulator-commandline?hl=ko) : ì‹¤ì œ Android ëŸ°íƒ€ì„ í™˜ê²½ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë””ë²„ê·¸ ë° í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” QEMU ê¸°ë°˜ ê¸°ê¸° ì—ë®¬ë ˆì´ì…˜ ë„êµ¬ì…ë‹ˆë‹¤.
	- [`mksdcard`](https://developer.android.com/studio/command-line/mksdcard?hl=ko) : SD ì¹´ë“œì™€ ê°™ì€ ì™¸ë¶€ ë©”ëª¨ë¦¬ ì¹´ë“œì˜ ì¡´ì¬ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•˜ê¸° ìœ„í•´ ì—ë®¬ë ˆì´í„°ì™€ í•¨ê»˜ ì‚¬ìš©í•  ë””ìŠ¤í¬ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---


 ë‚˜ëŠ” ì‹œìŠ¤í…œ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë° AVD ìƒì„±, ì—ë®¬ë ˆì´íŠ¸ë¥¼ í•´ì•¼ ë˜ê¸° ë•Œë¬¸ì— **`Android SDK ëª…ë ¹ì¤„ ë„êµ¬`** ì™€ **`Android Emulator`** ë¥¼ ë‹¤ìš´ë¡œë“œ í–ˆë‹¤.


ì²˜ìŒì— `Android Emulator` ëŠ” ì–´ë””ì„œ ë‹¤ìš´ë¡œë“œ í•˜ëŠ”ì§€ ëª°ë¼ì„œ í—¤ë§¸ì—ˆ


# Reference


[https://developer.android.com/tools?hl=ko](https://developer.android.com/tools?hl=ko)

